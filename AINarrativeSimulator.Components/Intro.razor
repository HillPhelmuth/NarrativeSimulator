@using NarrativeSimulator.Core


<div class="app-shell">
    <div class="intro-container @( _isGenerating ? "is-generating" : string.Empty)">
        <div class="mode-toggle">
            <label class="toggle-label">
                <input class="toggle-input" type="checkbox" @bind="_usePresetGroup" aria-label="Use a preset agent group" />
                <span class="toggle-track"><span class="toggle-thumb"></span></span>
                <span class="toggle-text">Use a preset agent group</span>
            </label>
        </div>

        @if (_usePresetGroup)
        {
            <div class="preset-panel @( _isGenerating ? "disabled" : string.Empty)">
                <h3 class="preset-title">Select a Preset Group</h3>
                <div class="preset-list">
                    @foreach (var g in _presetGroups)
                    {
                        <button type="button" class="preset-item" @onclick="() => SelectPreset(g)" disabled="@_isGenerating">
                            <div class="preset-item-header">
                                <span class="preset-name">@g.Name</span>
                                <span class="preset-count">@g.AgentCount agents</span>
                            </div>
                            <p class="preset-desc">@g.Description</p>
                        </button>
                    }
                </div>
            </div>
        }
        else
        {
            <CreateAgentsForm OnCreateAgents="CreateAgents" />
        }

        <div class="desc-panel">
            <h2 class="desc-title">
                <span class="desc-icon"></span>
                About This Simulation
            </h2>
            <div class="desc-grid">
                <div>
                    <h3 class="desc-h3">Emergent Narratives</h3>
                    <p>Watch as autonomous AI agents create their own stories through interactions, without any predetermined script. Each agent has unique personalities, relationships, and hidden knowledge.</p>
                </div>
                <div>
                    <h3 class="desc-h3">Real-time Reasoning</h3>
                    <p>Every few seconds, each agent perceives their environment and makes decisions based on their personality, goals, and memories. The story unfolds organically through their autonomous choices.</p>
                </div>
                <div>
                    <h3 class="desc-h3">Interactive Catalyst</h3>
                    <p>As the observer, you can introduce rumors, events, or environmental changes that serve as catalysts for new narrative directions, but you cannot directly control the agents.</p>
                </div>
            </div>

        </div>
    </div>

    @if (_isGenerating)
    {
        <div class="busy-overlay" role="status" aria-live="polite">
            <div class="spinner"></div>
            <div class="busy-text">Generating agents...</div>
        </div>
    }
</div>